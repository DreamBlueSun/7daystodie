<Marisa>

	<append xpath="/buffs/buff[@name='buffStatusCheck01']">
		<!-- 添加 状态检查 0.2s -->
        <effect_group>
			<requirement name="NotHasBuff" buff="buffStatusCheckMarisa02"/>
				<triggered_effect trigger="onSelfBuffUpdate" action="AddBuff" buff="buffStatusCheckMarisa02"/>
		</effect_group>

		<!-- 添加 不屈 -->
        <effect_group>
			<requirement name="ProgressionLevel" progression_name="perkMarisaNirvana" operation="Equals" value="1"/>
				<triggered_effect trigger="onSelfRespawn" action="RemoveBuff" buff="buffPerkMarisaNirvana2"/>
				<triggered_effect trigger="onSelfRespawn" action="AddBuff" buff="buffPerkMarisaNirvana"/>
		</effect_group>
        <effect_group>
			<requirement name="ProgressionLevel" progression_name="perkMarisaNirvana" operation="Equals" value="2"/>
				<triggered_effect trigger="onSelfRespawn" action="RemoveBuff" buff="buffPerkMarisaNirvana"/>
				<triggered_effect trigger="onSelfRespawn" action="AddBuff" buff="buffPerkMarisaNirvana2"/>
		</effect_group>

		<!-- 添加 力量解放 缓触发前置 -->
        <effect_group>
			<requirement name="ProgressionLevel" progression_name="perkMarisaLiberationPower" operation="GTE" value="1"/>
				<triggered_effect trigger="onOtherDamagedSelf" action="AddBuff" buff="buffPerkMarisaLiberationPowerBefore"/>
		</effect_group>
	</append>



	<!-- 正面BUFF -->
	<append xpath="/buffs">

		<!-- 状态检查 0.2s -->
		<buff name="buffStatusCheckMarisa02" hidden="true">
			<stack_type value="ignore"/>
			<update_rate value=".2"/>
			<duration value="0"/>
			<!-- 添加 瘴气环境 -->
			<effect_group>
				<requirement name="InBiome" biome="08"/>
				<requirement name="ProgressionLevel" progression_name="perkMarisaEnvironmentMiasmatic" operation="LT" value="1"/>
					<triggered_effect trigger="onSelfBuffUpdate" action="AddBuff" buff="buffEnvironmentMiasmatic"/>
			</effect_group>

			<!-- 添加 力量解放 -->
			<effect_group>
				<requirement name="ProgressionLevel" progression_name="perkMarisaLiberationPower" operation="GTE" value="1"/>
				<requirement name="StatComparePercCurrentToMax" stat="Health" operation="LTE" value=".35"/>
					<triggered_effect trigger="onSelfBuffUpdate" action="AddBuff" buff="buffPerkMarisaLiberationPower"/>
			</effect_group>

			<!-- 添加 抵御 护甲下降 -->
			<effect_group>
				<requirement name="ProgressionLevel" progression_name="perkMarisaDefDownResistance" operation="GTE" value="3"/>
					<triggered_effect trigger="onSelfBuffUpdate" action="AddBuff" buff="buffUnablePerkMarisaDefDown"/>
			</effect_group>

			<!-- 添加 抵御 瘴气侵蚀 -->
			<effect_group>
				<requirement name="ProgressionLevel" progression_name="perkMarisaMiasmaticErosionResistance" operation="GTE" value="3"/>
					<triggered_effect trigger="onSelfBuffUpdate" action="AddBuff" buff="buffUnablePerkMarisaMiasmaticErosion"/>
			</effect_group>

		</buff>
		<!-- 飞燕 -->
		<buff name="buffPerkMarisaNoguri" name_key="buffPerkMarisaNoguriName" description_key="buffPerkMarisaNoguriDesc" showonhud="true" icon="ui_game_symbol_run" icon_color="0,191,255">
			<stack_type value="replace"/>
			<duration value="5"/>
			<effect_group>
				<passive_effect name="EntityDamage" operation="perc_add" value=".2"/>
			</effect_group>
		</buff>

		<!-- 不屈 -->
		<buff name="buffPerkMarisaNirvana" name_key="buffPerkMarisaNirvanaName" description_key="buffPerkMarisaNirvanaDesc" showonhud="true" icon="ui_game_symbol_muscle" icon_color="0,191,255">
			<stack_type value="replace"/>
			<duration value="1200"/>
			<effect_group>
				<requirement name="!HoldingItemHasTags" tags="shotgun"/>
					<passive_effect name="EntityDamage" operation="base_add" value="5"/>
			</effect_group>
			<effect_group>
				<requirement name="HoldingItemHasTags" tags="shotgun"/>
					<passive_effect name="EntityDamage" operation="base_add" value=".5"/>
			</effect_group>
			<effect_group>
				<passive_effect name="PerkLevel" operation="base_add" value="1" tags="perkMarisaHealthChangeOT"/>
				<passive_effect name="PerkLevel" operation="base_add" value="2" tags="perkMarisaFoodLossPerDownHealthPointGained"/>
			</effect_group>
		</buff>
		<buff name="buffPerkMarisaNirvana2" name_key="buffPerkMarisaNirvana2Name" description_key="buffPerkMarisaNirvana2Desc" showonhud="true" icon="ui_game_symbol_muscle" icon_color="0,191,255">
			<stack_type value="replace"/>
			<duration value="1200"/>
			<effect_group>
				<requirement name="!HoldingItemHasTags" tags="shotgun"/>
					<passive_effect name="EntityDamage" operation="base_add" value="15"/>
			</effect_group>
			<effect_group>
				<requirement name="HoldingItemHasTags" tags="shotgun"/>
					<passive_effect name="EntityDamage" operation="base_add" value="1.5"/>
			</effect_group>
			<effect_group>
				<passive_effect name="PerkLevel" operation="base_add" value="3" tags="perkMarisaHealthChangeOT"/>
				<passive_effect name="PerkLevel" operation="base_add" value="2" tags="perkMarisaFoodLossPerDownHealthPointGained"/>
			</effect_group>
		</buff>

		<!-- 力量解放 缓触发前置 -->
		<buff name="buffPerkMarisaLiberationPowerBefore" hidden="true">
			<stack_type value="ignore"/>
			<duration value="60"/>
			<effect_group>
				<requirement name="ProgressionLevel" progression_name="perkMarisaLiberationPower" operation="GTE" value="1"/>
					<triggered_effect trigger="onSelfBuffRemove" action="AddBuff" buff="buffPerkMarisaLiberationPower"/>
			</effect_group>
		</buff>
		<!-- 力量解放 -->
		<buff name="buffPerkMarisaLiberationPower" name_key="buffPerkMarisaLiberationPowerName" description_key="buffPerkMarisaLiberationPowerDesc" showonhud="true" icon="ui_game_symbol_muscle" icon_color="0,191,255">
			<stack_type value="ignore"/>
			<update_rate value="1"/>
			<duration value="125"/>
			<effect_group>
				<requirement name="ProgressionLevel" progression_name="perkMarisaLiberationPower" operation="LT" value="1"/>
					<triggered_effect trigger="onSelfBuffUpdate" action="RemoveBuff" buff="buffPerkMarisaLiberationPower"/>
			</effect_group>
			<effect_group>
				<requirement name="ProgressionLevel" progression_name="perkMarisaLiberationPower" operation="Equals" value="1"/>
					<passive_effect name="EntityDamage" operation="perc_add" value=".1"/>
					<passive_effect name="StaminaChangeOT" operation="perc_add" value=".1"/>
			</effect_group>
			<effect_group>
				<requirement name="ProgressionLevel" progression_name="perkMarisaLiberationPower" operation="Equals" value="2"/>
					<passive_effect name="EntityDamage" operation="perc_add" value=".2"/>
					<passive_effect name="StaminaChangeOT" operation="perc_add" value=".2"/>
			</effect_group>
			<effect_group>
				<requirement name="ProgressionLevel" progression_name="perkMarisaLiberationPower" operation="Equals" value="3"/>
					<passive_effect name="EntityDamage" operation="perc_add" value=".3"/>
					<passive_effect name="StaminaChangeOT" operation="perc_add" value=".3"/>
			</effect_group>
			<effect_group>
				<requirement name="ProgressionLevel" progression_name="perkMarisaLiberationPower" operation="Equals" value="4"/>
					<passive_effect name="EntityDamage" operation="perc_add" value=".4"/>
					<passive_effect name="StaminaChangeOT" operation="perc_add" value=".4"/>
			</effect_group>
			<effect_group>
				<requirement name="ProgressionLevel" progression_name="perkMarisaLiberationPower" operation="Equals" value="5"/>
					<passive_effect name="EntityDamage" operation="perc_add" value=".5"/>
					<passive_effect name="StaminaChangeOT" operation="perc_add" value=".5"/>
			</effect_group>
		</buff>

		<!-- 跳跃性能 -->
		<buff name="buffPerkMarisaJumpDef" name_key="buffPerkMarisaJumpDefName" description_key="buffPerkMarisaJumpDefDesc" showonhud="true" icon="ui_game_symbol_run" icon_color="0,191,255">
			<stack_type value="ignore"/>
			<effect_group>
				<passive_effect name="GeneralDamageResist" operation="base_set" value="1"/>
			</effect_group>
		</buff>

		<!-- 死里逃生 -->
		<buff name="buffPerkMarisaNarrowEscape" name_key="buffPerkMarisaNarrowEscapeName" description_key="buffPerkMarisaNarrowEscapeDesc" showonhud="true" icon="ui_game_symbol_run" icon_color="0,191,255">
			<stack_type value="replace"/>
			<duration value="2"/>
			<effect_group>
				<passive_effect name="PerkLevel" operation="base_add" value="2" tags="perkMarisaJumpDef"/>
				<passive_effect name="StaminaLoss" operation="perc_add" value="-.2"/>
				<passive_effect name="StaminaChangeOT" operation="perc_add" value=".1"/>
			</effect_group>
		</buff>

		<!-- 防御缓冲 -->
		<buff name="buffPerkMarisaDefensiveBufferBefore" name_key="buffPerkMarisaDefensiveBufferBeforeName" description_key="buffPerkMarisaDefensiveBufferBeforeDesc" showonhud="true" icon="server_cheat" icon_color="255,0,55">
			<stack_type value="replace"/>
			<effect_group>
				<requirement name="ProgressionLevel" progression_name="perkMarisaDefensiveBuffer" operation="GTE" value="1"/>
					<triggered_effect trigger="onSelfBuffRemove" action="PlaySound" sound="twitch_good_buff_ended" play_in_head="true"/>
					<triggered_effect trigger="onSelfBuffRemove" action="AddBuff" buff="buffPerkMarisaDefensiveBufferReady"/>
			</effect_group>
		</buff>
		<buff name="buffPerkMarisaDefensiveBufferReady" name_key="buffPerkMarisaDefensiveBufferReadyName" description_key="buffPerkMarisaDefensiveBufferReadyDesc" showonhud="true" icon="server_cheat" icon_color="0,255,0">
			<stack_type value="replace"/>
			<duration value="0"/>
			<effect_group>
				<requirement name="ProgressionLevel" progression_name="perkMarisaDefensiveBuffer" operation="GTE" value="1"/>
				<triggered_effect trigger="onOtherDamagedSelf" action="PlaySound" sound="open_apache_artifact_chest" play_in_head="true"/>
				<triggered_effect trigger="onOtherDamagedSelf" action="RemoveBuff" buff="buffPerkMarisaDefensiveBufferReady"/>
				<triggered_effect trigger="onOtherDamagedSelf" action="AddBuff" buff="buffPerkMarisaDefensiveBuffer"/>
			</effect_group>
		</buff>
		<buff name="buffPerkMarisaDefensiveBuffer" name_key="buffPerkMarisaDefensiveBufferName" description_key="buffPerkMarisaDefensiveBufferDesc" showonhud="true" icon="server_cheat" icon_color="0,191,255">
			<stack_type value="replace"/>
			<duration value="5"/>
			<effect_group>
                <passive_effect name="PhysicalDamageResist" operation="base_add" value="100"/>
                <passive_effect name="ElementalDamageResist" operation="base_add" value="100"/>
				<passive_effect name="GeneralDamageResist" operation="base_set" value="1"/>
			</effect_group>
			<effect_group>
				<requirement name="ProgressionLevel" progression_name="perkMarisaDefensiveBuffer" operation="Equals" value="1"/>
					<triggered_effect trigger="onSelfBuffRemove" action="AddBuff" buff="buffPerkMarisaDefensiveBufferBefore" duration="60"/>
			</effect_group>
			<effect_group>
				<requirement name="ProgressionLevel" progression_name="perkMarisaDefensiveBuffer" operation="Equals" value="2"/>
					<triggered_effect trigger="onSelfBuffRemove" action="AddBuff" buff="buffPerkMarisaDefensiveBufferBefore" duration="50"/>
			</effect_group>
			<effect_group>
				<requirement name="ProgressionLevel" progression_name="perkMarisaDefensiveBuffer" operation="Equals" value="3"/>
					<triggered_effect trigger="onSelfBuffRemove" action="AddBuff" buff="buffPerkMarisaDefensiveBufferBefore" duration="40"/>
			</effect_group>
			<effect_group>
				<requirement name="ProgressionLevel" progression_name="perkMarisaDefensiveBuffer" operation="Equals" value="4"/>
					<triggered_effect trigger="onSelfBuffRemove" action="AddBuff" buff="buffPerkMarisaDefensiveBufferBefore" duration="30"/>
			</effect_group>
			<effect_group>
				<requirement name="ProgressionLevel" progression_name="perkMarisaDefensiveBuffer" operation="Equals" value="5"/>
					<triggered_effect trigger="onSelfBuffRemove" action="AddBuff" buff="buffPerkMarisaDefensiveBufferBefore" duration="20"/>
			</effect_group>
		</buff>

		<!-- 广域化 -->
		<buff name="buffPerkMarisaFriendlyTips" name_key="buffPerkMarisaFriendlyTipsName" description_key="buffPerkMarisaFriendlyTipsDesc" showonhud="true" icon="server_peer" icon_color="0,191,255">
			<stack_type value="replace"/>
			<duration value="10"/>
		</buff>

		<!-- 炸弹客 -->
		<buff name="buffPerkMarisaBombermanDef" name_key="buffPerkMarisaBombermanDefName" description_key="buffPerkMarisaBombermanDefDesc" showonhud="true" icon="ui_game_symbol_explosion" icon_color="0,191,255">
			<stack_type value="ignore"/>
			<effect_group>
				<passive_effect name="GeneralDamageResist" operation="base_set" value="1"/>
			</effect_group>
		</buff>


		<!-- ** 抵御 护甲下降 -->
		<buff name="buffUnablePerkMarisaDefDown" hidden="true">
			<stack_type value="replace"/>
			<duration value="3"/>
		</buff>

		<!-- ** 抵御 瘴气侵蚀 -->
		<buff name="buffUnablePerkMarisaMiasmaticErosion" hidden="true">
			<stack_type value="replace"/>
			<duration value="3"/>
		</buff>
	</append>



	<!-- *** 负面BUFF -->
	<append xpath="/buffs">

		<!-- ** 瘴气环境 -->
		<buff name="buffEnvironmentMiasmatic" name_key="buffEnvironmentMiasmaticName" description_key="buffEnvironmentMiasmaticDesc" showonhud="true" icon="ui_game_symbol_infection" icon_color="255,0,55">
			<stack_type value="ignore"/>
			<update_rate value="3"/>
			<duration value="60"/>
			<effect_group>
				<triggered_effect trigger="onSelfBuffUpdate" action="ModifyStats" stat="Health" target="self" operation="add" value="-1"/>
			</effect_group>
		</buff>

		<!-- ** 护甲下降 -->
		<buff name="buffPerkMarisaDefDown" name_key="buffPerkMarisaDefDownName" description_key="buffPerkMarisaDefDownDesc" showonhud="true" icon="server_cheat" icon_color="255,0,55">
			<stack_type value="replace"/>
			<update_rate value="1"/>
			<duration value="60"/>
			<effect_group>
				<requirement name="ProgressionLevel" progression_name="perkMarisaDefDownResistance" operation="LT" value="1"/>
					<passive_effect name="PhysicalDamageResist" operation="base_add" value="-40"/>
			</effect_group>
			<effect_group>
				<requirement name="ProgressionLevel" progression_name="perkMarisaDefDownResistance" operation="Equals" value="1"/>
					<passive_effect name="PhysicalDamageResist" operation="base_add" value="-20"/>
			</effect_group>
			<effect_group>
				<requirement name="ProgressionLevel" progression_name="perkMarisaDefDownResistance" operation="Equals" value="2"/>
					<passive_effect name="PhysicalDamageResist" operation="base_add" value="-10"/>
			</effect_group>
			<effect_group>
				<requirement name="ProgressionLevel" progression_name="perkMarisaDefDownResistance" operation="GTE" value="3"/>
					<triggered_effect trigger="onSelfBuffUpdate" action="RemoveBuff" buff="buffPerkMarisaDefDown"/>
			</effect_group>
		</buff>

		<!-- ** 瘴气侵蚀 -->
		<buff name="buffPerkMarisaMiasmaticErosion" name_key="buffPerkMarisaMiasmaticErosionName" description_key="buffPerkMarisaMiasmaticErosionDesc" showonhud="true" icon="ui_game_symbol_infection" icon_color="255,0,55">
			<stack_type value="replace"/>
			<update_rate value="1"/>
			<duration value="60"/>
			<effect_group>
				<requirement name="ProgressionLevel" progression_name="perkMarisaMiasmaticErosionResistance" operation="LT" value="1"/>
					<passive_effect name="HealthMax" operation="perc_add" value="-.4"/>
					<passive_effect name="StaminaMax" operation="perc_add" value="-.4"/>
			</effect_group>
			<effect_group>
				<requirement name="ProgressionLevel" progression_name="perkMarisaMiasmaticErosionResistance" operation="Equals" value="1"/>
					<passive_effect name="HealthMax" operation="perc_add" value="-.2"/>
					<passive_effect name="StaminaMax" operation="perc_add" value="-.2"/>
			</effect_group>
			<effect_group>
				<requirement name="ProgressionLevel" progression_name="perkMarisaMiasmaticErosionResistance" operation="Equals" value="2"/>
					<passive_effect name="HealthMax" operation="perc_add" value="-.1"/>
					<passive_effect name="StaminaMax" operation="perc_add" value="-.1"/>
			</effect_group>
			<effect_group>
				<requirement name="ProgressionLevel" progression_name="perkMarisaMiasmaticErosionResistance" operation="GTE" value="3"/>
					<triggered_effect trigger="onSelfBuffUpdate" action="RemoveBuff" buff="buffPerkMarisaMiasmaticErosion"/>
			</effect_group>
		</buff>

	</append>
	<!-- ** 热 -->
	<append xpath="/buffs/buff[@name='buffElementHot']">
		<effect_group>
			<passive_effect name="StaminaChangeOT" operation="perc_add" value="-.2"/>
		</effect_group>
	</append>
	<!-- ** 酷热 -->
	<append xpath="/buffs/buff[@name='buffElementSweltering']">
		<effect_group>
			<passive_effect name="StaminaChangeOT" operation="perc_add" value="-.4"/>
		</effect_group>
	</append>
	<!-- ** 寒冷 -->
	<append xpath="/buffs/buff[@name='buffElementCold']">
		<effect_group>
			<passive_effect name="StaminaLoss" operation="perc_add" value=".2"/>
		</effect_group>
	</append>
	<!-- ** 冻僵 -->
	<append xpath="/buffs/buff[@name='buffElementFreezing']">
		<effect_group>
			<passive_effect name="StaminaLoss" operation="perc_add" value=".4"/>
		</effect_group>
	</append>



	<!-- 武器BUFF -->
	<append xpath="/buffs">

		<!-- 烈焰净世 -->
		<buff name="buffModBuffFireAoeEffect" hidden="true">
			<damage_type value="heat"/>
			<stack_type value="replace"/>
			<update_rate value="1"/>
			<duration value="30"/>
			<effect_group>
				<passive_effect name="HealthChangeOT" operation="base_subtract" value="@buffModBuffFireAoeEffect"/>

				<triggered_effect trigger="onSelfBuffStart" action="AttachParticleEffectToEntity" particle="p_onFire"/>
				<triggered_effect trigger="onSelfBuffRemove" action="RemoveParticleEffectFromEntity" particle="p_onFire"/>
				<triggered_effect trigger="onSelfDied" action="RemoveParticleEffectFromEntity" particle="p_onFire"/>
			</effect_group>
		</buff>

		<!-- 虹彩拳套 -->
		<buff name="buffMarisaModKnucklesRunSpeed" name_key="buffMarisaModKnucklesRunSpeedName" description_key="buffMarisaModKnucklesRunSpeedDesc" showonhud="true" icon="ui_game_symbol_fire" icon_color="255,71,207">
			<stack_type value="duration"/>
			<duration value="15"/>
			<effect_group>
				<triggered_effect trigger="onSelfBuffRemove" action="ModifyCVar" cvar=".buffMarisaModKnucklesRunSpeed" operation="set" value="0"/>
				<passive_effect name="RunSpeed" operation="perc_add" value="@.buffMarisaModKnucklesRunSpeed">
					<requirement name="ItemHasTags" tags="perkBrawler"/>
				</passive_effect>
			</effect_group>
		</buff>
		<buff name="buffMarisaModKnucklesAttacksPerMinute" name_key="buffMarisaModKnucklesAttacksPerMinuteName" description_key="buffMarisaModKnucklesAttacksPerMinuteDesc" showonhud="true" icon="ui_game_symbol_fire" icon_color="255,71,207">
			<stack_type value="duration"/>
			<duration value="15"/>
			<effect_group>
				<triggered_effect trigger="onSelfBuffRemove" action="ModifyCVar" cvar=".buffMarisaModKnucklesAttacksPerMinute" operation="set" value="0"/>
				<passive_effect name="AttacksPerMinute" operation="perc_add" value="@.buffMarisaModKnucklesAttacksPerMinute">
					<requirement name="ItemHasTags" tags="perkBrawler"/>
				</passive_effect>
			</effect_group>
		</buff>
		<buff name="buffMarisaModKnucklesTargetArmor" name_key="buffMarisaModKnucklesTargetArmorName" description_key="buffMarisaModKnucklesTargetArmorDesc" showonhud="true" icon="ui_game_symbol_fire" icon_color="255,71,207">
			<stack_type value="duration"/>
			<duration value="15"/>
			<effect_group>
				<triggered_effect trigger="onSelfBuffRemove" action="ModifyCVar" cvar=".buffMarisaModKnucklesTargetArmor" operation="set" value="0"/>
				<passive_effect name="TargetArmor" operation="perc_subtract" value="@.buffMarisaModKnucklesTargetArmor">
					<requirement name="ItemHasTags" tags="perkBrawler"/>
				</passive_effect>
			</effect_group>
		</buff>

	</append>

	<!-- 武器BUFF 附属 -->
    <remove xpath="/buffs/buff[@name='buffIsOnFire']"/>
	<append xpath="/buffs">
		<buff name="buffIsOnFire" name_key="buffIsOnFireName" description_key="buffIsOnFireDesc" tooltip_key="buffIsOnFireTooltip" icon="ui_game_symbol_fire" icon_color="255,0,0" icon_blink="true">
			<damage_type value="Heat"/>
			<stack_type value="ignore"/>
			<duration value="0"/>
			<update_rate value="0.5"/>
			<display_value value=".buffIsOnFireDisplay"/>
			<display_value_format value="time"/>

			<effect_group>
			<!-- Extinguish any fire if wet or if buffExtinguishFire is executed -->
				<requirements compare_type="or">
					<requirement name="RandomRoll" seed_type="Random" min_max="0,1" operation="LTE" value="@_wetness"/>
					<requirement name="HasBuff" buff="buffExtinguishFire"/>
					<requirement name="CVarCompare" cvar="_underwater" operation="GTE" value="0.3"/>
				</requirements>
						<triggered_effect trigger="onSelfBuffUpdate" action="RemoveBuff" buff="buffBurningFlamingArrow"/>
						<triggered_effect trigger="onSelfBuffUpdate" action="RemoveBuff" buff="buffBurningMolotov"/>
						<triggered_effect trigger="onSelfBuffUpdate" action="RemoveBuff" buff="buffBurningEnvironmentHack"/>
						<triggered_effect trigger="onSelfBuffUpdate" action="RemoveBuff" buff="buffBurningEnvironment"/>
						<triggered_effect trigger="onSelfBuffUpdate" action="RemoveBuff" buff="buffBurningElement"/>
						<triggered_effect trigger="onSelfBuffUpdate" action="RemoveBuff" buff="buffHazardBurningElement" />
			</effect_group>

			<effect_group>
				<!-- If the various durations are GT buffIsOnFireDisplay, set the duration to the value of buffIsOnFireDisplay -->
				<triggered_effect trigger="onSelfBuffStart" action="ModifyCVar" cvar=".buffIsOnFireDisplay" operation="set" value="@$buffBurningFlamingArrowDuration"/>
				<triggered_effect trigger="onSelfBuffStart" action="ModifyCVar" cvar=".buffIsOnFireDisplay" operation="set" value="@$buffBurningMolotovDuration"/>
				<triggered_effect trigger="onSelfBuffStart" action="ModifyCVar" cvar=".buffIsOnFireDisplay" operation="set" value="@$BurningEnvironmentDuration">
					<requirement name="CVarCompare" cvar="$BurningEnvironmentDuration" operation="GT" value="@.buffIsOnFireDisplay"/></triggered_effect>
				<triggered_effect trigger="onSelfBuffStart" action="ModifyCVar" cvar=".buffIsOnFireDisplay" operation="set" value="@$buffBurningElementDuration">
					<requirement name="CVarCompare" cvar="$buffBurningElementDuration" operation="GT" value="@.buffIsOnFireDisplay"/></triggered_effect>
				<triggered_effect trigger="onSelfBuffStart" action="ModifyCVar" cvar=".buffIsOnFireDisplay" operation="set" value="@$buffHazardBurningElementDuration">
					<requirement name="CVarCompare" cvar="$buffHazardBurningElementDuration" operation="GT" value="@.buffIsOnFireDisplay"/></triggered_effect>

				<triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar=".buffIsOnFireDisplay" operation="set" value="@$buffBurningFlamingArrowDuration"/>
				<triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar=".buffIsOnFireDisplay" operation="set" value="@$buffBurningMolotovDuration"/>
				<triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar=".buffIsOnFireDisplay" operation="set" value="@$BurningEnvironmentDuration">
					<requirement name="CVarCompare" cvar="$BurningEnvironmentDuration" operation="GT" value="@.buffIsOnFireDisplay"/></triggered_effect>
				<triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar=".buffIsOnFireDisplay" operation="set" value="@$buffBurningElementDuration">
					<requirement name="CVarCompare" cvar="$buffBurningElementDuration" operation="GT" value="@.buffIsOnFireDisplay"/></triggered_effect>
				<triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar=".buffIsOnFireDisplay" operation="set" value="@$buffHazardBurningElementDuration">
					<requirement name="CVarCompare" cvar="$buffHazardBurningElementDuration" operation="GT" value="@.buffIsOnFireDisplay"/></triggered_effect>
			</effect_group>

			<effect_group>
				<!-- Terminate only if all burn buffs are gone -->
				<requirements>
					<requirement name="!HasBuff" buff="buffBurningFlamingArrow"/>
					<requirement name="!HasBuff" buff="buffBurningMolotov"/>
					<requirement name="!HasBuff" buff="buffBurningEnvironmentHack"/>
					<requirement name="!HasBuff" buff="buffBurningEnvironment"/>
					<requirement name="!HasBuff" buff="buffBurningElement"/> <!-- torch, burning zombie -->
					<requirement name="!HasBuff" buff="buffHazardBurningElement"/>
					<requirement name="!HasBuff" buff="buffModBuffFireAoeEffect"/>
				</requirements>
					<triggered_effect trigger="onSelfBuffUpdate" action="RemoveBuff" buff="buffIsOnFire"/>
			</effect_group>
			<!-- Start and clean up particles and sounds -->
			<effect_group name="run particles, cleanup">
				<triggered_effect trigger="onSelfBuffRemove" action="RemoveCVar" cvar=".buffIsOnFireDisplay"/>

				<triggered_effect trigger="onSelfBuffRemove" action="RemoveParticleEffectFromEntity" particle="p_onFire"/>
				<triggered_effect trigger="onSelfDied" action="RemoveParticleEffectFromEntity" particle="p_onFire"/>

				<triggered_effect trigger="onSelfBuffStart" action="PlaySound" sound="buff_burn_lp"/>
				<triggered_effect trigger="onSelfBuffRemove" action="StopSound" sound="buff_burn_lp"/>
				<triggered_effect trigger="onSelfBuffRemove" action="PlaySound" sound="buff_burn_extinguish"/>
			</effect_group>

			<effect_group>
				<requirements><requirement name="!IsSDCS"/></requirements>
				<triggered_effect trigger="onSelfBuffStart" action="AttachParticleEffectToEntity" particle="p_onFire" local_offset="0,0,0" parent_transform="LOD0" shape_mesh="true"/>
				<triggered_effect trigger="onSelfEnteredGame" action="AttachParticleEffectToEntity" particle="p_onFire" local_offset="0,0,0" parent_transform="LOD0" shape_mesh="true"/>
			</effect_group>

			<effect_group>
				<requirements><requirement name="IsSDCS"/></requirements>
				<triggered_effect trigger="onSelfBuffStart" action="AttachParticleEffectToEntity" particle="p_onFire" parent_transform=".body" shape_mesh="true"/>
				<triggered_effect trigger="onSelfEnteredGame" action="AttachParticleEffectToEntity" particle="p_onFire" parent_transform=".body" shape_mesh="true"/>
			</effect_group>
		</buff>
	</append>



	<!-- 特效BUFF -->
	<append xpath="/buffs">

		<!-- 黄绿色闪烁烟花团 -->
		<buff name="buffMarisaRadiatedParticlesOnMesh" hidden="true">
			<stack_type value="replace"/>
			<duration value="0"/>
			<effect_group>
				<triggered_effect trigger="onSelfBuffStart" action="AttachParticleEffectToEntity" particle="RadiatedParticlesOnMesh" local_offset="0,1,0"/>
				<triggered_effect trigger="onSelfDied" action="RemoveParticleEffectFromEntity" particle="RadiatedParticlesOnMesh"/>
			</effect_group>
		</buff>
		<!-- 白色烟雾团 -->
		<buff name="buffMarisaSmoke_Unlit" hidden="true">
			<stack_type value="replace"/>
			<duration value="0"/>
			<effect_group>
				<triggered_effect trigger="onSelfBuffStart" action="AttachParticleEffectToEntity" particle="Smoke_Unlit" local_offset="0,1.25,0"/>
				<triggered_effect trigger="onSelfDied" action="RemoveParticleEffectFromEntity" particle="Smoke_Unlit"/>
			</effect_group>
		</buff>
		<!-- 耀斑 -->
		<buff name="buffMarisaP_smoke" hidden="true">
			<stack_type value="replace"/>
			<duration value="0"/>
			<effect_group>
				<triggered_effect trigger="onSelfBuffStart" action="AttachParticleEffectToEntity" particle="p_smoke" local_offset="0,1.25,0"/>
				<triggered_effect trigger="onSelfDied" action="RemoveParticleEffectFromEntity" particle="p_smoke"/>
			</effect_group>
		</buff>
		<!-- 烽火烟 -->
		<buff name="buffMarisaP_signal_flarePrefab" hidden="true">
			<stack_type value="replace"/>
			<duration value="0"/>
			<effect_group>
				<triggered_effect trigger="onSelfBuffStart" action="AttachParticleEffectToEntity" particle="p_signal_flarePrefab" local_offset="0,0.75,0"/>
				<triggered_effect trigger="onSelfDied" action="RemoveParticleEffectFromEntity" particle="p_signal_flarePrefab"/>
			</effect_group>
		</buff>
		<!-- 大范围瘴气烟幕（浅色） -->
		<buff name="buffMarisaP_smokestorm" hidden="true">
			<stack_type value="replace"/>
			<duration value="0"/>
			<effect_group>
				<triggered_effect trigger="onSelfBuffStart" action="AttachParticleEffectToEntity" particle="p_smokestorm" local_offset="0,1,0"/>
				<triggered_effect trigger="onSelfDied" action="RemoveParticleEffectFromEntity" particle="p_smokestorm"/>
			</effect_group>
		</buff>
		<!-- 大范围暴风雪烟幕（浅白色） -->
		<buff name="buffMarisaP_snowstorm1" hidden="true">
			<stack_type value="replace"/>
			<duration value="0"/>
			<effect_group>
				<triggered_effect trigger="onSelfBuffStart" action="AttachParticleEffectToEntity" particle="p_snowstorm1" local_offset="0,1,0"/>
				<triggered_effect trigger="onSelfDied" action="RemoveParticleEffectFromEntity" particle="p_snowstorm1"/>
			</effect_group>
		</buff>


	</append>

</Marisa>
